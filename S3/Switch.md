以下范围来自bjl的《2023期末复习要点》word版本和yq的《期末复习2023》ppt，内容求并集，非交集部分会打*。

部分内容直接照搬了前人笔记。

# 概论

## 通信网（三要素）

![image-20230603141037289](https://s2.loli.net/2023/06/03/uUbLgJMV726x5YE.png)

## 交换方式的特点

### 电路交换

 电话通信中信息的传送方式：**公共交换电话网（Public Switched Telephone Network，PSTN）**，每一路能提供 64k 速率。

电路交换的特点

- 信息传送的最小单位是时隙：每个时隙采样 8bit，采样率 8kHz，每路通信速率 64kbps。

- 面向连接的工作方式（物理连接）。
- 同步时分复用（固定带宽分配）。
- 无差错控制机制（实时性强）。
- 对通信信息不作处理（透明传输）。
- 流量控制基于呼叫损失制。

**适合实时性、恒定速率的业务。**

![image-20230603141202391](https://s2.loli.net/2023/06/03/zRvDPU5ZwxVkumo.png)

### 分组交换

机制——存储+转发。

分组交换的特点：

- **信息传送的最小单位是分组**：由分组头、用户信息构成，分组头含有选路和控制信息。
- 面向连接（虚电路）方式和无连接（数据报）方式。
- 统计时分复用，动态分配带宽。
- 有差错控制机制：CRC 校验、重发等（设于第二层和第三层协议中）。
- 信息传送不具有透明性：对通信信息作处理，如拆分、重组等。
- 流量控制基于呼叫延迟制。

**适用于突发、对差错敏感的数据业务。**

|            | 虚电路             | 数据报                 |
| ---------- | ------------------ | ---------------------- |
| 分组头     | 简单（逻辑信道号） | 复杂（详细的选路信息） |
| 选路       | 虚连接表           | 每个分组独立选路       |
| 分组顺序   | 有序               | 可能失序               |
| 故障敏感性 | 敏感               | 可靠性高               |
| 应用       | 连续数据流         | 询问/响应              |

### 各类交换方式的基本信息交换单元

| 交换类型 | 基本信息交换单元 |
| -------- | ---------------- |
| 电路交换 | 时隙             |
| 报文交换 | 报文             |
| 分组交换 | 分组             |
| 帧中继   | 帧               |
| ATM 交换 | 信元             |

## 复用技术

### 同步时分复用

- 用于电路交换。
- 采用位置化信道：
  - 根据数字信号在**时间轴**上的位置区别各路。无信息传送时，也会占用信道。
  - 每帧定长。
  - 信号经过复用器和分路器的时延低（1~2 帧）。

### 统计时分复用

分为分组化时分复用、异步时分复用。

- 用于分组交换、ATM 交换。

- 采用标志化信道：使用分组头的标志区分各路通信。

#### 分组化时分复用

- 每个分组前附加标志码，标识分组的输出端或传送路径，与时间无关。
- 分组长度可变、分组头定界。
- 统计复用提高信道利用率。具有一定容量的排队存贮器，解决瞬间的出线冲突。
- 传输时延较小且稳定、处理时延与分组大小有关、排队时延与突发流量有关。

#### 异步时分复用

- 位置固定的标志化信道。
- 信元长度固定、插入空信元保持同步。
- 时延较为稳定。

## 连接类型

### 面向连接/无连接

面向连接：

- 无论物理或逻辑连接，通信分为三阶段：连接建立、传送信息、连接拆除。
- 连接建立后，传送的所有信息均沿此路径传送，保证信息有序性。
- 信息传送的时延（比无连接）小。
- 对网络故障敏感。

无连接：

- 没有连接建立过程，边选路边传送。
- 同一通信的信息到达目的地的路径无法预知，不保证信息有序性。
- 信息传送的时延（比面向连接）大。
- 对网络故障不敏感。

### 物理连接/逻辑连接（虚电路）

同：都具有连接建立、传送信息、连接拆除三阶段。

异：物理连接建立一条通信源和目的之间的物理连接通路；逻辑连接没有物理连接，通过在通信连接上的所有交换节点保存选路结果和路由连接关系实现逻辑上的连接。

## 带宽分配

### 固定带宽分配

### 动态带宽分配

见“复用技术”。

## 目前交换技术的种类和特点

![image-20230603144940947](https://s2.loli.net/2023/06/03/u1SznymXc6AqRBt.png)

## *各种常用网络的交换方式

| 网络       | 交换方式   |
| ---------- | ---------- |
| PSTN电话网 | 电路       |
| B_ISDN     | 分组       |
| Internet   | 分组       |
| No7信令网  | 电路       |
| GSM网络    | 电路       |
| GPRS网络   | 电路&分组  |
| 4G网络     | 分组       |
| 5G网络     | 分组       |
| IMS系统    | 分组       |
| MPLS网络   | 带标记分组 |

## *各种常用网络的重要信令/协议

| 网络     | 信令/协议 |
| -------- | --------- |
| PSTN     | No.7      |
| IMS      | ?  |
| MPLS     | LDP、SIP  |
| SDN      | Openflow  |
| Internet | IP        |
| LDP | ?        |
| SIP | ?        |

## *电信交换系统的基本结构

由信息传送子系统和控制子系统组成。

- 信息传送子系统：
  - 交换网络：完成交换，实现任意出线与入线的互联。
  - 各种接口：分为用户接口和中继接口，用途是进行信号转换。
- 控制子系统：由处理机系统构成，是交换系统的“指挥中心”。

![image-20230603170345837](https://s2.loli.net/2023/06/03/a3SAxB7NKfn9Wl2.png)

### 程控电话交换机

![image-20230603170405590](https://s2.loli.net/2023/06/03/a4bxt1qgQL9STvG.png)

![image-20230603170948125](https://s2.loli.net/2023/06/03/DRXO4M728dof3yJ.png)

### IP路由器

什么东西...

随便在mooc上找的一张图，反正我觉得这个不考。

![image-20230603171433061](https://s2.loli.net/2023/06/03/TqaDIyZVhfeP5kU.png)

### MPLS路由器

![image-20230603171625815](https://s2.loli.net/2023/06/03/EL7TM5WOQuvtN1w.png)

![image-20230603171732426](https://s2.loli.net/2023/06/03/I7HT6GleYWKPBfi.png)

# 交换网络

## 连接概念

连接

- 集合描述法：所有入线序号为集合$T$，出线序号为集合$R$。连接$c = \{t,R_t\}, t \in T , R_t \subset R$
- 函数描述法：$f(t)=R_t,\space R_t \subset R$
- 排列表达式：$\begin{pmatrix}
  t_1 && t_2 && \cdots && t_n \\
  r_1 && r_2 && \cdots && r_n \\
  \end{pmatrix}$，入线排列表达式$(0,1,2...,N-2,N-1)$
- 图形表示法：略
- 二进制函数表示：$E(x_{n-1}x_{n-2}...x_1x_0)=x_{n-1}x_{n-2}...x_1\bar{x_0}$，表示点到点二进制编号。

一个$N \times N$的交换单元最多可以有$N!$种不同的点到点连接方式。

连接方式

- 直线连接：略

<img src="https://s2.loli.net/2023/06/03/RIuZqW1F7CgMsVc.png" alt="image-20210617195519390" style="zoom: 33%;" />

- 交叉连接（交换置换）：$(1,0,3,2,...,N-1,N-2)$，$E(x_{n-1}x_{n-2}...x_1x_0)=x_{n-1}x_{n-2}...x_1\bar{x_0}$

<img src="https://s2.loli.net/2023/06/03/b6OyAWz3SVgoF5B.png" alt="image-20210617195606140" style="zoom:33%;" />

- 蝶式连接：$\beta (x_{n-1}x_{n-2}...x_1x_0)=x_0x_{n-2}...x_1x_{n-1}$，将输入端二进制最高位$x_{n-1}$与最低位$x_0$互换位置得到。

<img src="https://s2.loli.net/2023/06/03/oaWSqvItLx7bZsQ.png" alt="image-20210617195640668" style="zoom:33%;" />

- 均匀洗牌置换：将入线均分，前一部分和后一部分按顺序一个接一个交叉连接。$\delta(x_{n-1}x_{n-2}...x_1x_0)=x_{n-2}x_{n-3}...x_1x_0x_{n-1}$，将入线二进制地址循环左移一位得到。
- 间隔交叉连接（方体置换）：实现二进制地址编号中第 k 位位置不同的输入端和输出端之间的连接。

<img src="https://s2.loli.net/2023/06/03/aNP435m2LH6B87y.png" alt="image-20210617200821165" style="zoom:33%;" />

~~一点系统结构震撼~~

### 点对点、同发、广播

对于连接$c = \{t,R_t\}, (t \in T , R_t \subset R)$

- 如果$R_t$只有唯一元素，为点到点连接。

- 如果$R_t$包含多个元素，为点到多点连接。

  - 如果$R_t \ne R$，为同发。
  - 如果$R_t = R$，为广播。

  ![image-20230530201514331](https://s2.loli.net/2023/06/03/8DnfC2sM9wWR7h5.png)

## 交换单元的结构、特性、工作原理

基本交换单元的结构、特性（需要的单元个数、是否内部阻塞、同发和广播能力）

### 基本交换单元与开关阵列

- M\*N 有向

![image-20210617201425659](https://s2.loli.net/2023/06/03/JgyatrRL28nCw1N.png)

采用矩阵表示开关通断：

$$
\begin{pmatrix}
1 && 0 && \cdots && 0 \\
0 && 0 && \cdots && 1 \\
\vdots && \vdots && \ddots && \vdots \\
0 && 1 && \cdots && 0
\end{pmatrix}
$$

**不允许出线冲突时，同 column 只允许一个 1 出现；不允许同发广播时，同 row 只允许一个 1 出现。**

- N 无向

特点是主对角线不连通。需要$N(N-1)/2$个双向开关，或者$N(N-1)$个单向开关。

![image-20210617203003483](https://s2.loli.net/2023/06/03/NRVrWJix13HUvT4.png)

- M\*N 无向

需要$M \times N$个双向开关，或者$2 \times M \times N$个单向开关。

![image-20210617203412693](https://s2.loli.net/2023/06/03/ZRw2tAzyU9XWNCD.png)

#### 开关阵列性质

- 空分交换。
- 容易实现同发和广播。
- 交换动作控制简单，信息从入线到出线具有均匀的单位延迟时间：信息从任一入线到任一出线经过的开关数是相等的，不存在时延抖动。
- 开关阵列的控制简单。
- **适用于构成较小规模的交换单元。**

- 开关阵列的性能取决于所用的开关性能。（继电器、模拟电子开关、数字电子开关）

- 无内部阻塞。

实际实现：

- 可用多路选择器。

- 可用 2\*2 交叉连接单元（crossbar）：可以避免出线冲突，但不支持同发。

### S 接线器

- 构成：
  - 交叉点矩阵（开关阵列）。
  - 一组控制存储器（CM，Control Memory）。
- 功能：**实现一个时隙内任意母线间的交换。**

- 规格：
  - 一个 S 接线器所含控制存储器 CM 的数量=入（出）线数。（输入控制 CM 数=入线数，反之）
  - 每个控制存储器 CM 含有的存储单元个数=时隙数。
  - 每个存储单元中存储索引存储单元的地址，为 m 位 bit，且满足$N \le 2^m$，其中 N 为接线器的入（出）线数。
- CM 具有输入控制方式与输出控制方式：
  - **输入控制：控制一条输入线与每一条输出线的交叉点的开启与闭合，存储单元的内容表示对应输入复用线与哪一个输出复用线的交叉点开关在该存储单元所对应的时隙内接通**（对于入线$a$，在当前时隙$TS_i$，从$CM_a$的$i$号存储单元读出需要交换到的出线$b$，打开输入线$a$与$b$相交叉的开关，完成空间交换）
  - **输出控制：控制一条输出线与每一条输入线的交叉点的开启与闭合，存储单元的内容表示对应输出复用线上哪个交叉点在该存储单元所对应的时隙内接通**（对于出线$b$，在当前时隙$TS_i$，从$CM_a$的$i$号存储单元读出接受输入的入线$a$，打开输入线$a$与$b$相交叉的开关，完成空间交换）

<img src="https://s2.loli.net/2023/06/03/FWH5lTOgXJiofEk.png" alt="image-20210617233335178" style="zoom:50%;" />

<img src="https://s2.loli.net/2023/06/03/6NjPZmWu8c7LTKE.png" alt="image-20210617233440479" style="zoom:50%;" />

特性：

- 只完成空间交换，不进行时隙交换。
- 空间接线器按时分方式工作。
- **输<u>出</u>控制方式易于实现多播（将多个 CM 的$TS_i$的存储单元置为同一条输入线即可）。**
- **输出控制方式可自动避免出线冲突。**

![image-20230530201722392](https://s2.loli.net/2023/06/03/B4Rp2yXNJ5dWrOK.png)

### T 接线器

时分交换单元一般分为：共享存储器型交换单元、共享总线型交换单元。

- 共享存储器型：共 2N 个出入线缓存。入线缓存控制读出、出线缓存控制写入。
- 共享总线型：总线按照时隙轮流分配给入线控制部件和出线控制部件使用。
  - $kNV=B/T$（N 为入线数、V 为入线速率、B 为每时隙传送比特数、T 为时隙长度，k 为时隙分配因子）

**异同：**

- 相同点：
  - 两种时分交换单元内部都只有一条唯一的通路，由各子信道分时共享；
- 不同点：
  - 共享存储器型内部唯一的公共通路是存储器，共享总线型内部唯一的公共通路是总线；
  - 共享存储器型的存储器被划分成 N 个区域，N 路输入信号被放在存储器的 N 个区域中， 不同区域的 N 路信号被读出形成 N 路输出信号；共享总线型则按照总线控制权的分配方法，把总线的工作时间划分为多个时段（最简单的是划分为 N 个时隙），在每个时段内把总线分给某条入线；当输入部件获得总线上的输入时隙后把入线的信号送到总线上，同时，对应的输出部件将总线上的信息读入并从出线上输出信息；
  - 共享存储器型交换速度与控制器有关，共享总线型交换速度与总线宽度有关。

**时间接线器的构成：**

- T 接线器
  - 话音存储器（SM，Speech Memory）：暂存话音的数字编码信息。
    - 存储单元个数等于 PCM 线路每帧时隙数；每单元至少 8bit（一路话音）。
  - 控制存储器（CM，Control Memory）：
    - 存储单元个数等于 SM；每单元至少$log_2n（n 为时隙数）$比特。

时间接线器输出控制方式：顺序写入、控制读出。

- SM：前半周期顺序写入话音、后半周期从地址读出话音

- CM：前半周期顺序写入控制地址、后半周期控制读出话音。

  缺点：复用级别越高，对控制电路要求越高，无法达成很大规模；时隙转换延迟不定。

![image-20210618002435156](https://s2.loli.net/2023/06/03/XCspm8HQat5jc6K.png)

时间接线器输入控制方式：控制写入、顺序读出。

![image-20210618002449171](https://s2.loli.net/2023/06/03/XIATOhVdSjNuJmv.png)

特性：

- **时分交换，适用于同步时分复用和统计时分复用信号。**
- SM 划分为 N 个区域，每个区域一个字节，存放一个话音数据。各个区域间不共享，无排队缓冲。
- 存储容量足够大时，无内部阻塞。
- 容量受到信号存储器工作速度和控制器工作速度的控制。
- 交换的控制过程由 CM 硬件实现，速度快。
- 交换时延小且稳定，延迟时间不均匀。
- 严格无阻塞，并且可避免出线冲突。
- **易于实现同发和广播。**
- 速率固定。

![image-20230603173656930](https://s2.loli.net/2023/06/03/EJSBN9fIVglzWQ6.png)

![image-20230530215913179](https://s2.loli.net/2023/06/03/hB2WoIbYctapC17.png)

## 无阻塞网络概念

严格无阻：只要需要交换的入线与出线空闲，就可以通过交换网络建立一个连接。

可重排无阻：只要需要交换的入线与出线空闲，就可以通过交换网络直接地或对已有连接进行重排之后建立一个连接。

广义无阻：给定的网络存在着固有的阻塞可能，但又**可能**存在一种精巧的选路方法，使得只要需要交换的入线与出线空闲，**不必重排**，就可以通过交换网络建立连接。

### CLOS 网络：严格无阻、可重排无阻公式和构造

3 级 CLOS 严格无阻：$m \ge 2n-1$

3 级 CLOS 可重排无阻：$m \ge n$

构造法：根据要求确定中间级个数$m$，一三级分别采用$n \times m$和$m \times n$交换单元，$r=N \div n$（一三级单元个数），中间级采用$r \times r$交换单元。

![image-20210618005822162](https://s2.loli.net/2023/06/03/utmvkYnCoVKxENM.png)

### TST：结构、SM 和 CM 容量和内容、反向半帧、同发特性

详见三电话交换系统.数字交换网络。

![image-20210618012220878](https://s2.loli.net/2023/06/03/kxKjYse3LgXvJVb.png)

内部阻塞：存在，但概率很小，约为$10^{-6}$。

同发特性：

* 初T 顺入控出， S 输出控制/输入控制， 次T 控入顺出。
* 初T 控入顺出， S 输出控制/输入控制， 次T 顺入控出。

特性：

- 反向路由的半帧选择；
- 控制存储器的合用；
- 无内部阻塞条件。

### BANYAN 网络

特性：唯一路径、有阻塞（内部竞争）、单通路、基于树形结构所以能自选路。

**构造法：**构造$N \times N$的 BANYAN 网络，需要$log_2N$级，每级$N/2$个交换单元。拿两个$n \times n$网络，**将$n$个$2\times 2$交换单元作为一级通过混洗连接到前部、或者通过反转混洗连接到尾部。**

![image-20210618010232494](https://s2.loli.net/2023/06/03/4mGtY6TVle3kw9p.png)

降低阻塞方法：

- 增加网络级数（如 BENES 网络），每增加一级，通路数翻倍。但同时失去唯一路径和自选路特性。
- 使用扩展型或膨胀型 banyan 网络。
- batcher-banyan（排序-banyan）网络：严格无阻塞、结构规整、自动选路。
- 减少入线的信息量，加大入线缓存。
- 增加平面数，构造多通道交换网络。（几平面就是几倍的交换单元）

### BENES 网络

两个 banyan 网络背靠背连接，并将中间两级合并为一级。**是可重排无阻塞网络，多通路。**

$N \times N$的BENES网络需要$(N/2) \times (2 \times log_2N-1)$个$2 \times 2$交叉单元。

![image-20210618005420985](https://s2.loli.net/2023/06/03/iYXp39EmM1ZJx8s.png)

![image-20230530232952411](https://s2.loli.net/2023/06/03/NuiOZeLbyXhl81I.png)

# 电路交换（话音交换）

## 程控数字交换机的硬件

### 程控数字交换机的系统结构

![image-20210618143045260](https://s2.loli.net/2023/06/03/diYnKxStvL75Qsw.png)
![image-20230531224131711](https://s2.loli.net/2023/06/03/1K2ekgOfhSr7AvP.png)

![image-20230531190750480](https://s2.loli.net/2023/06/03/RpHtLKcumZDJMb2.png)

### 模拟用户电路的基本功能（不要求电路）

用户电路功能：BORSCHT

- 馈电（Battery feeding）：向用户提供直流馈电电流，电压-48V。
- 过压保护（Overvoltage protection）：二极管用于钳制电压，无论外线电压高于或低于内线，都会由二极管钳制内线为-48V，R 为热敏电阻，可自行烧毁。
- 振铃控制（Ring control）：控制是否向用户线发送 25Hz 铃流信号。
- 监视（Supervision）：监视用户环路的通断状态，通过电阻的直流压降得知用户是否摘机。
- 编译码和滤波（CODEC&filters）：模拟话音信号与 64Kbps 数字话音信号转换。对模拟信号进行编码、对数字信号进行解码；为避免混叠失真、50Hz 干扰、3400Hz 以上频率分量，进行滤波。
- 混合电路（Hybrid circuit）：在用户话机的 2 线双向信号和 PCM 的 4 线单向信号之间进行 2/4 转换。（发生在编码之前和译码之后）
- 测试（Test）：控制是否进行内外线的故障检测。

![image-20230603175012524](https://s2.loli.net/2023/06/03/UNOtofXdmDyuMvW.png)
